<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Méthodologie</title>
  <link rel="stylesheet" href="../css/style.css">
  <script src="../js/cursor.js" defer></script>
  <style>
    .code-block-wrapper {
      background-color: #1e1e2e;
      border-radius: 8px;
      padding: 0;
      margin: 1.5rem 0;
      font-family: 'Consolas', 'Courier New', monospace;
      font-size: 0.85rem;
      overflow: hidden;
      border: 1px solid #313244;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      max-width: 100%;
      min-width: 0;
    }
    .code-block-header {
      background-color: #313244;
      color: #cdd6f4;
      padding: 8px 16px;
      display: flex;
      align-items: center;
      gap: 50px;
      font-size: 0.8rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    .code-block-header::before {
      content: '';
      display: inline-block;
      width: 12px; height: 12px;
      border-radius: 50%;
      background-color: #f38ba8;
      box-shadow: 20px 0 0 #fab387, 40px 0 0 #a6e3a1;
      flex-shrink: 0;
    }
    .code-block-wrapper pre {
      margin: 0;
      padding: 1.2rem 1.5rem;
      overflow-x: auto;
      overflow-y: visible;
      max-width: 100%;
      line-height: 1.6;
      color: #cdd6f4;
      white-space: pre;
      word-break: normal;
    }
    .c-keyword  { color: #cba6f7; }
    .c-string   { color: #a6e3a1; }
    .c-comment  { color: #6c7086; font-style: italic; }
    .c-function { color: #89b4fa; }
    .c-number   { color: #fab387; }
    .c-operator { color: #89dceb; }
    .c-template { color: #f9e2af; }

    @media (max-width: 600px) {
      .code-block-wrapper pre { font-size: 0.72rem; padding: 1rem; }
      .code-block-header       { font-size: 0.7rem;  gap: 16px;    }
      .code-block-header::before { display: none; }
    }
  </style>
</head>
<body>
  <canvas id="c"></canvas>

  <header>
    <nav>
      <a href="../index.html">Accueil & Contexte</a>
      <a href="models.html">Modèles & Hardware</a>
      <a href="use_cases.html">Cas d'Usage & Marché</a>
      <a href="future.html">Vision 2030</a>
      <a href="methodology.html" class="active">Méthodologie</a>
    </nav>
  </header>

  <div id="scroll-space">
    <div style="height:100vh;pointer-events:none;"></div>

    <div class="drive-gap"></div>

    <!-- 01 - INTRO -->
    <section class="drive-section">
      <div class="card">
        <span class="tag">01 - MÉTHODOLOGIE</span>
        <h2>Méthodologie & Stack Technique</h2>
        <p>Cette veille est le résultat d'une approche hybride combinant traitement humain et automatisation par Intelligence Artificielle. Le processus se divise en deux flux distincts : la constitution du corpus documentaire de base et la veille temps réel automatisée.</p>
      </div>
    </section>

    <div class="drive-gap"></div>

    <!-- 02 - STRATÉGIE -->
    <section class="drive-section">
      <div class="card">
        <span class="tag">02 - STRATÉGIE DE RECHERCHE</span>
        <h2>Stratégie de Recherche & Définition du Périmètre</h2>
        <p>En amont de la rédaction, l'environnement technologique a été cartographié à l'aide de moteurs de recherche conversationnels avancés tels que Perplexity et Gemini (mode Deep Search). Ces outils ont permis d'identifier rapidement les concepts émergents : SLM, Physical AI, VLA Models, ainsi que les acteurs clés comme NVIDIA Thor ou Qualcomm Oryon, tout en écartant les sources généralistes trop superficielles au profit de blogs techniques de niche (NVIDIA Developer Blog, Hugging Face Papers).</p>
        <p>Cette phase a également abouti à la génération de requêtes booléennes complexes destinées à filtrer le bruit informationnel, par exemple : <code>"Small Language Model" AND "Automotive" - "Cloud"</code>. L'objectif était de délimiter précisément le périmètre de la veille avant toute collecte automatisée.</p>
      </div>
    </section>

    <div class="drive-gap"></div>

    <!-- 03 - COLLECTE -->
    <section class="drive-section">
      <div class="card">
        <span class="tag">03 - COLLECTE & CURATION</span>
        <h2>Collecte & Curation (Zotero & RSS)</h2>
        <p>La sélection des articles fondateurs du site repose sur une agrégation stricte via Zotero, utilisé comme agrégateur RSS central. Les flux des blogs d'ingénierie y ont été regroupés aux côtés d'alertes Google configurées sur des thématiques précises (par exemple, <em>"Mistral 7B Automotive"</em>) et redirigées en flux RSS plutôt que par email, permettant une intégration directe dans l'outil de tri.</p>
        <p>Chaque article retenu pour la rédaction a ensuite fait l'objet d'une lecture manuelle, d'un tagage thématique et d'un archivage dans Zotero, garantissant la traçabilité et la fiabilité des sources citées sur ce site.</p>
      </div>
    </section>

    <div class="drive-gap"></div>

    <!-- 04 - ARCHITECTURE -->
    <section class="drive-section">
      <div class="card">
        <span class="tag">04 - ARCHITECTURE D'AUTOMATISATION</span>
        <h2>Architecture d'Automatisation (Live Feed)</h2>
        <p>Le flux d'actualités présent en bas de chaque page de ce site est entièrement automatisé via une architecture <em>Serverless</em> et Low-Code, articulée autour de trois composants : la collecte des flux, le filtrage par IA, et l'exposition des données via une API JSON.</p>
      </div>
    </section>

    <div class="drive-gap"></div>

    <!-- 05 - COLLECTE APPS SCRIPT -->
    <section class="drive-section">
      <div class="card">
        <span class="tag">05 - COLLECTE AUTOMATISÉE</span>
        <h2>A. Collecte Automatisée (Google Apps Script)</h2>
        <p>Un script personnalisé hébergé sur Google Cloud s'exécute automatiquement chaque jour. Il scanne une liste de flux RSS couvrant des sources spécialisées : blogs NVIDIA, arXiv, Reddit r/LocalLLaMA, Hugging Face Trending, ainsi que huit alertes Google configurées sur des mots-clés ciblés. Pour chaque flux, le script détecte automatiquement le format (Atom ou RSS standard), extrait les titres, liens et dates de publication, et dédoublonne les entrées via une comparaison avec les liens déjà stockés en base.</p>

        <h3 style="margin-top:1.2rem;margin-bottom:0.5rem;">Flux RSS surveillés</h3>
        <ul>
          <li>https://blogs.nvidia.com/blog/category/auto/feed/</li>
          <li>http://export.arxiv.org/api/query?search_query=all:quantization+AND+all:LLM&start=0&max_results=10</li>
          <li>https://feeds.feedburner.com/nvidiablog</li>
          <li>http://export.arxiv.org/rss/cs.AI</li>
          <li>https://techcrunch.com/category/artificial-intelligence/feed/</li>
          <li>https://www.reddit.com/r/LocalLLaMA/top/.rss?t=week</li>
          <li>https://zernel.github.io/huggingface-trending-feed/feed.xml</li>
        </ul>

        <h3 style="margin-top:1.2rem;margin-bottom:0.5rem;">Google Alerts configurées</h3>
        <ul>
          <li>("Agentic AI" OR "Function calling") AND ("Vehicle control" OR "ADAS" OR "Voice assistant" OR "Automotive")</li>
          <li>("Generative AI" OR "LLM" OR "SLM") AND "Automotive" AND ("Safety" OR "Hallucination" OR "Latency" OR "Privacy")</li>
          <li>("NVIDIA DRIVE Thor" OR "Snapdragon Digital Chassis" OR "Qualcomm" OR "Intel Automotive") AND ("GenAI" OR "LLM" OR "NPU" OR "SLM" OR "AI")</li>
          <li>("SLM" OR "Small Language Model" OR "TinyML") AND ("Automotive" OR "In-vehicle" OR "Cockpit")</li>
          <li>("Snapdragon Digital Chassis" OR "NVIDIA DRIVE Thor" OR "Mobileye EyeQ") AND ("Quantization" OR "INT8" OR "Pruning")</li>
          <li>("Stellantis" OR "Volkswagen" OR "Renault" OR "BMW" OR "Mercedes" OR "Waymo" OR "Weride") AND ("SLM" OR "Mistral AI" OR "Llama" OR "Generative AI")</li>
          <li>site:arxiv.org ("Small Language Model" OR "SLM" OR "Edge AI") AND ("Automotive" OR "Vehicle")</li>
        </ul>
      </div>
    </section>

    <div class="drive-gap"></div>

    <!-- 06 - FILTRAGE GROQ -->
    <section class="drive-section">
      <div class="card">
        <span class="tag">06 - FILTRAGE IA</span>
        <h2>B. Filtrage Intelligent (IA via API Groq)</h2>
        <p>Pour éviter le "bruit" informationnel, chaque titre d'article est soumis à un modèle de langage (Llama 3.1 8B) via l'API Groq. Le prompt impose un arbre de décision strict en deux étapes : d'abord un filtre de rejet pour les sujets hors-scope (médecine, finance, crypto), puis une catégorisation parmi six tags : <em>hardware, software_models, use_cases, manufacturers, future, contexte</em>. Tout article non classifiable est rejeté avec le label <em>autre</em>. Un mécanisme de retry (3 tentatives, pause de 10s sur erreur 429) assure la robustesse face aux limites de débit de l'API.</p>
      </div>
    </section>

    <div class="drive-gap"></div>

    <!-- 07 - STOCKAGE & API -->
    <section class="drive-section">
      <div class="card">
        <span class="tag">07 - STOCKAGE & API</span>
        <h2>C. Stockage & API (Google Sheets)</h2>
        <p>Les articles validés sont écrits dans une feuille Google Sheets jouant le rôle de base de données légère. Cette même feuille est exposée en tant qu'API JSON publique via la fonction <code>doGet()</code>, qui retourne les 50 articles les plus récents, triés par date décroissante, directement consommables par le navigateur de l'utilisateur sans aucun backend intermédiaire.</p>

        <div class="code-block-wrapper">
          <div class="code-block-header">Apps Script – Google Sheets Automation</div>
          <pre><code><span class="c-comment">// ==========================================</span>
<span class="c-comment">// 1. CONFIGURATION</span>
<span class="c-comment">// ==========================================</span>
<span class="c-keyword">const</span> GROQ_API_KEY <span class="c-operator">=</span> <span class="c-string">"gsk_xxx"</span>;
<span class="c-keyword">const</span> GROQ_MODEL   <span class="c-operator">=</span> <span class="c-string">"llama-3.1-8b-instant"</span>;

<span class="c-keyword">const</span> RSS_URLS <span class="c-operator">=</span> [
  <span class="c-string">"https://www.google.fr/alerts/feeds/13679352391490227375/13514125029556601403"</span>,
  <span class="c-string">"https://www.google.fr/alerts/feeds/13679352391490227375/537131559348505229"</span>,
  <span class="c-string">"https://www.google.fr/alerts/feeds/13679352391490227375/9110558325910702791"</span>,
  <span class="c-string">"https://www.google.fr/alerts/feeds/13679352391490227375/4122885177354724118"</span>,
  <span class="c-string">"https://www.google.fr/alerts/feeds/13679352391490227375/103813396756190836"</span>,
  <span class="c-string">"https://www.google.fr/alerts/feeds/13679352391490227375/9945621874752529365"</span>,
  <span class="c-string">"https://www.google.fr/alerts/feeds/13679352391490227375/6848064440929761067"</span>,
  <span class="c-string">"https://www.reddit.com/r/LocalLLaMA/top/.rss?t=week"</span>,
  <span class="c-string">"https://blogs.nvidia.com/blog/category/auto/feed/"</span>,
  <span class="c-string">"http://export.arxiv.org/api/query?search_query=all:quantization+AND+all:LLM&amp;start=0&amp;max_results=10&amp;sortBy=submittedDate&amp;sortOrder=descending"</span>,
  <span class="c-string">"https://feeds.feedburner.com/nvidiablog"</span>,
  <span class="c-string">"https://zernel.github.io/huggingface-trending-feed/feed.xml"</span>,
  <span class="c-string">"http://export.arxiv.org/rss/cs.AI"</span>,
  <span class="c-string">"https://techcrunch.com/category/artificial-intelligence/feed/"</span>,
];

<span class="c-comment">// ==========================================</span>
<span class="c-comment">// 2. FONCTION PRINCIPALE</span>
<span class="c-comment">// ==========================================</span>
<span class="c-keyword">function</span> <span class="c-function">fetchAndStoreNews</span>() {
  <span class="c-keyword">const</span> sheet <span class="c-operator">=</span> SpreadsheetApp.getActiveSpreadsheet().getSheetByName(<span class="c-string">'Data'</span>);
  <span class="c-keyword">if</span> (!sheet) { SpreadsheetApp.getActiveSpreadsheet().insertSheet(<span class="c-string">'Data'</span>); }

  <span class="c-keyword">const</span> lastRow <span class="c-operator">=</span> sheet.getLastRow();
  <span class="c-keyword">const</span> existingLinks <span class="c-operator">=</span> lastRow <span class="c-operator">&gt;</span> <span class="c-number">1</span>
    <span class="c-operator">?</span> sheet.getRange(<span class="c-number">2</span>, <span class="c-number">3</span>, lastRow <span class="c-operator">-</span> <span class="c-number">1</span>).getValues().flat()
    : [];

  <span class="c-keyword">let</span> articlesToProcess <span class="c-operator">=</span> [];

  <span class="c-comment">// --- ÉTAPE 1 : RÉCUPÉRATION DES FLUX ---</span>
  RSS_URLS.forEach(url <span class="c-operator">=&gt;</span> {
    <span class="c-keyword">try</span> {
      <span class="c-keyword">const</span> response <span class="c-operator">=</span> UrlFetchApp.fetch(url, {muteHttpExceptions: <span class="c-keyword">true</span>});
      <span class="c-keyword">if</span> (response.getResponseCode() <span class="c-operator">!==</span> <span class="c-number">200</span>) <span class="c-keyword">return</span>;

      <span class="c-keyword">const</span> root <span class="c-operator">=</span> XmlService.parse(response.getContentText()).getRootElement();
      <span class="c-keyword">const</span> atom <span class="c-operator">=</span> XmlService.getNamespace(<span class="c-string">'http://www.w3.org/2005/Atom'</span>);

      <span class="c-keyword">let</span> entries <span class="c-operator">=</span> root.getName() <span class="c-operator">===</span> <span class="c-string">'feed'</span>
        <span class="c-operator">?</span> root.getChildren(<span class="c-string">'entry'</span>, atom)
        : (root.getChild(<span class="c-string">'channel'</span>) <span class="c-operator">?</span> root.getChild(<span class="c-string">'channel'</span>).getChildren(<span class="c-string">'item'</span>) : []);

      <span class="c-keyword">const</span> limit <span class="c-operator">=</span> (url.includes(<span class="c-string">"huggingface"</span>) <span class="c-operator">||</span> url.includes(<span class="c-string">"arxiv"</span>)) <span class="c-operator">?</span> <span class="c-number">5</span> : <span class="c-number">10</span>;
      entries <span class="c-operator">=</span> entries.slice(<span class="c-number">0</span>, limit);

      entries.forEach(entry <span class="c-operator">=&gt;</span> {
        <span class="c-keyword">let</span> link <span class="c-operator">=</span> <span class="c-string">""</span>, title <span class="c-operator">=</span> <span class="c-string">""</span>, published <span class="c-operator">=</span> <span class="c-string">""</span>;

        <span class="c-keyword">if</span> (root.getName() <span class="c-operator">===</span> <span class="c-string">'feed'</span>) {
          <span class="c-keyword">const</span> linkElem <span class="c-operator">=</span> entry.getChild(<span class="c-string">'link'</span>, atom);
          link      <span class="c-operator">=</span> linkElem <span class="c-operator">?</span> linkElem.getAttribute(<span class="c-string">'href'</span>).getValue() : <span class="c-string">""</span>;
          title     <span class="c-operator">=</span> entry.getChild(<span class="c-string">'title'</span>, atom).getText();
          published <span class="c-operator">=</span> entry.getChild(<span class="c-string">'published'</span>, atom)<span class="c-operator">?.</span>getText() <span class="c-operator">??</span> <span class="c-keyword">new</span> Date().toISOString();
        } <span class="c-keyword">else</span> {
          link      <span class="c-operator">=</span> entry.getChild(<span class="c-string">'link'</span>).getText();
          title     <span class="c-operator">=</span> entry.getChild(<span class="c-string">'title'</span>).getText();
          published <span class="c-operator">=</span> entry.getChild(<span class="c-string">'pubDate'</span>)<span class="c-operator">?.</span>getText() <span class="c-operator">??</span> <span class="c-keyword">new</span> Date().toISOString();
        }

        title <span class="c-operator">=</span> title.replace(<span class="c-operator">/</span>&lt;[^&gt;]+&gt;<span class="c-operator">/g</span>, <span class="c-string">''</span>).trim();
        <span class="c-keyword">if</span> (!existingLinks.includes(link) <span class="c-operator">&amp;&amp;</span> title.length <span class="c-operator">&gt;</span> <span class="c-number">5</span>) {
          articlesToProcess.push({ title, link, published, category: <span class="c-keyword">null</span> });
          existingLinks.push(link);
        }
      });
    } <span class="c-keyword">catch</span> (e) {
      console.log(<span class="c-string">"Erreur Flux RSS ("</span> <span class="c-operator">+</span> url <span class="c-operator">+</span> <span class="c-string">") : "</span> <span class="c-operator">+</span> e);
    }
  });

  <span class="c-comment">// --- ÉTAPE 2 : FILTRAGE LOCAL (REGEX) ---</span>
  <span class="c-keyword">let</span> articlesForGroq <span class="c-operator">=</span> [];

  articlesToProcess.forEach(article <span class="c-operator">=&gt;</span> {
    <span class="c-keyword">const</span> localCat <span class="c-operator">=</span> <span class="c-function">classifyLocalRegex</span>(article.title);
    <span class="c-keyword">if</span> (localCat) {
      article.category <span class="c-operator">=</span> localCat;
      <span class="c-keyword">if</span> (localCat <span class="c-operator">!==</span> <span class="c-string">'autre'</span>) {
        sheet.appendRow([article.published, article.title, article.link, article.category]);
        console.log(<span class="c-template">`[LOCAL] Ajouté [${article.category}] : ${article.title}`</span>);
      }
    } <span class="c-keyword">else</span> {
      articlesForGroq.push(article);
    }
  });

  <span class="c-comment">// --- ÉTAPE 3 : BATCHING API GROQ ---</span>
  <span class="c-keyword">if</span> (articlesForGroq.length <span class="c-operator">&gt;</span> <span class="c-number">0</span>) {
    <span class="c-function">processInBatches</span>(articlesForGroq, sheet);
  }
}

<span class="c-comment">// ==========================================</span>
<span class="c-comment">// 3. CLASSIFICATION LOCALE (ZÉRO TOKEN)</span>
<span class="c-comment">// ==========================================</span>
<span class="c-keyword">function</span> <span class="c-function">classifyLocalRegex</span>(title) {
  <span class="c-keyword">const</span> t <span class="c-operator">=</span> title.toLowerCase();

  <span class="c-keyword">if</span> (<span class="c-operator">/</span>(médecine|cancer|bitcoin|crypto|nft|biology|santé)<span class="c-operator">/i</span>.test(t)) <span class="c-keyword">return</span> <span class="c-string">'autre'</span>;
  <span class="c-keyword">if</span> (<span class="c-operator">/</span>(nvidia|amd|qualcomm|snapdragon|soc|npu|gpu|tops|silicon|chip|semiconductor)<span class="c-operator">/i</span>.test(t)) <span class="c-keyword">return</span> <span class="c-string">'hardware'</span>;
  <span class="c-keyword">if</span> (<span class="c-operator">/</span>(llama|qwen|mistral|phi-3|slm|llm|quantization|7b|8b|70b|parameter|distillation|fine-tuning)<span class="c-operator">/i</span>.test(t)) <span class="c-keyword">return</span> <span class="c-string">'software_models'</span>;
  <span class="c-keyword">if</span> (<span class="c-operator">/</span>(tesla|bmw|mercedes|waymo|weride|ford|toyota|oem|robotaxi)<span class="c-operator">/i</span>.test(t)) <span class="c-keyword">return</span> <span class="c-string">'manufacturers'</span>;

  <span class="c-keyword">return</span> <span class="c-keyword">null</span>;
}

<span class="c-comment">// ==========================================</span>
<span class="c-comment">// 4. TRAITEMENT PAR LOTS (GROQ)</span>
<span class="c-comment">// ==========================================</span>
<span class="c-keyword">function</span> <span class="c-function">processInBatches</span>(articles, sheet) {
  <span class="c-keyword">const</span> BATCH_SIZE <span class="c-operator">=</span> <span class="c-number">10</span>;

  <span class="c-keyword">for</span> (<span class="c-keyword">let</span> i <span class="c-operator">=</span> <span class="c-number">0</span>; i <span class="c-operator">&lt;</span> articles.length; i <span class="c-operator">+=</span> BATCH_SIZE) {
    <span class="c-keyword">const</span> batch <span class="c-operator">=</span> articles.slice(i, i <span class="c-operator">+</span> BATCH_SIZE);
    <span class="c-keyword">const</span> categories <span class="c-operator">=</span> <span class="c-function">classifyBatchWithGroq</span>(batch.map(a <span class="c-operator">=&gt;</span> a.title));

    batch.forEach((article, index) <span class="c-operator">=&gt;</span> {
      article.category <span class="c-operator">=</span> categories[index] <span class="c-operator">||</span> <span class="c-string">'autre'</span>;
      <span class="c-keyword">if</span> (article.category <span class="c-operator">!==</span> <span class="c-string">'autre'</span>) {
        sheet.appendRow([article.published, article.title, article.link, article.category]);
        console.log(<span class="c-template">`[GROQ] Ajouté [${article.category}] : ${article.title}`</span>);
      }
    });

    Utilities.sleep(<span class="c-number">3000</span>);
  }
}

<span class="c-comment">// ==========================================</span>
<span class="c-comment">// 5. APPEL API GROQ (OPTIMISÉ POUR BATCH)</span>
<span class="c-comment">// ==========================================</span>
<span class="c-keyword">function</span> <span class="c-function">classifyBatchWithGroq</span>(titlesArray) {
  <span class="c-keyword">const</span> prompt <span class="c-operator">=</span> <span class="c-template">`
Tu es un classificateur strict spécialisé dans l'IA Embarquée, l'Automobile et la performance des modèles (SLM/LLM).
Voici un tableau JSON de ${titlesArray.length} titres d'articles :
${JSON.stringify(titlesArray)}

Pour CHAQUE titre, assigne UNE SEULE de ces catégories :
- "hardware"        : Puces, GPU, NPU, TOPS, silicium.
- "software_models" : Algorithmes, SLM, LLM, quantization, RAG.
- "use_cases"       : ADAS, cockpit intelligent, infotainment dans le véhicule.
- "manufacturers"   : Constructeurs auto, robotaxis, usines, partenariats.
- "future"          : Prospective, régulations, horizons 2030, GreenOps.
- "contexte"        : Marché global Edge AI ou automobile.
- "autre"           : Hors-sujet (médecine, finance, web pur, etc.).

RÈGLE ABSOLUE : Réponds UNIQUEMENT par un tableau JSON valide de ${titlesArray.length} chaînes, dans le MÊME ORDRE.
Exemple : ["software_models", "autre", "hardware"]`</span>;

  <span class="c-keyword">const</span> options <span class="c-operator">=</span> {
    method: <span class="c-string">"post"</span>, contentType: <span class="c-string">"application/json"</span>,
    headers: { Authorization: <span class="c-string">"Bearer "</span> <span class="c-operator">+</span> GROQ_API_KEY },
    payload: JSON.stringify({
      model: GROQ_MODEL,
      messages: [{ role: <span class="c-string">"user"</span>, content: prompt }],
      temperature: <span class="c-number">0.0</span>, max_tokens: <span class="c-number">150</span>
    }),
    muteHttpExceptions: <span class="c-keyword">true</span>
  };

  <span class="c-keyword">for</span> (<span class="c-keyword">let</span> attempt <span class="c-operator">=</span> <span class="c-number">0</span>; attempt <span class="c-operator">&lt;</span> <span class="c-number">3</span>; attempt<span class="c-operator">++</span>) {
    <span class="c-keyword">try</span> {
      <span class="c-keyword">const</span> res  <span class="c-operator">=</span> UrlFetchApp.fetch(<span class="c-string">"https://api.groq.com/openai/v1/chat/completions"</span>, options);
      <span class="c-keyword">const</span> code <span class="c-operator">=</span> res.getResponseCode();

      <span class="c-keyword">if</span> (code <span class="c-operator">===</span> <span class="c-number">200</span>) {
        <span class="c-keyword">let</span> content <span class="c-operator">=</span> JSON.parse(res.getContentText()).choices[<span class="c-number">0</span>].message.content.trim();
        content <span class="c-operator">=</span> content.replace(<span class="c-operator">/</span>```json<span class="c-operator">/g</span>, <span class="c-string">''</span>).replace(<span class="c-operator">/</span>```<span class="c-operator">/g</span>, <span class="c-string">''</span>).trim();
        <span class="c-keyword">const</span> parsed <span class="c-operator">=</span> JSON.parse(content);
        <span class="c-keyword">if</span> (Array.isArray(parsed) <span class="c-operator">&amp;&amp;</span> parsed.length <span class="c-operator">===</span> titlesArray.length) <span class="c-keyword">return</span> parsed;
      } <span class="c-keyword">else</span> <span class="c-keyword">if</span> (code <span class="c-operator">===</span> <span class="c-number">429</span>) {
        console.warn(<span class="c-string">"Erreur 429 : Pause de 10s..."</span>);
        Utilities.sleep(<span class="c-number">10000</span>);
      }
    } <span class="c-keyword">catch</span> (e) {
      console.error(<span class="c-string">"Erreur API : "</span> <span class="c-operator">+</span> e);
      Utilities.sleep(<span class="c-number">5000</span>);
    }
  }

  <span class="c-keyword">return</span> <span class="c-keyword">new</span> Array(titlesArray.length).fill(<span class="c-string">'autre'</span>);
}

<span class="c-comment">// ==========================================</span>
<span class="c-comment">// 6. API POUR LE SITE WEB</span>
<span class="c-comment">// ==========================================</span>
<span class="c-keyword">function</span> <span class="c-function">doGet</span>(e) {
  <span class="c-keyword">const</span> sheet <span class="c-operator">=</span> SpreadsheetApp.getActiveSpreadsheet().getSheetByName(<span class="c-string">'Data'</span>);
  <span class="c-keyword">if</span> (!sheet <span class="c-operator">||</span> sheet.getLastRow() <span class="c-operator">&lt;</span> <span class="c-number">2</span>)
    <span class="c-keyword">return</span> ContentService.createTextOutput(JSON.stringify([]))
      .setMimeType(ContentService.MimeType.JSON);

  <span class="c-keyword">const</span> rows <span class="c-operator">=</span> sheet.getDataRange().getValues();
  rows.shift();

  <span class="c-keyword">let</span> data <span class="c-operator">=</span> rows
    .map(row <span class="c-operator">=&gt;</span> ({ date: row[<span class="c-number">0</span>], title: row[<span class="c-number">1</span>], link: row[<span class="c-number">2</span>], topic: row[<span class="c-number">3</span>] }))
    .sort((a, b) <span class="c-operator">=&gt;</span> <span class="c-keyword">new</span> Date(b.date) <span class="c-operator">-</span> <span class="c-keyword">new</span> Date(a.date))
    .slice(<span class="c-number">0</span>, <span class="c-number">50</span>);

  <span class="c-keyword">return</span> ContentService.createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}</code></pre>
        </div>


        <p id="google-sheet-link-container">
          <a href="https://docs.google.com/spreadsheets/d/1oCypRQoLJ1zjwaQMwPYFEr3XLmEUstojZxdJGRdwqSU/edit?gid=0#gid=0" target="_blank" id="google-sheet-link">Accéder à la base de données Google Sheets</a>
        </p>
      </div>
    </section>

    <div class="drive-gap"></div>

    <section class="drive-section" id="news-container">
      <div class="card">
        <span class="tag">Flux Brut</span>
        <h2>Dernières actualités techniques</h2>
        <ul id="news-list"><li id="news-loading-placeholder">Chargement...</li></ul>
      </div>
    </section>
    
    <footer>
      <div class="footer-inner">
    
        <div class="footer-subject">
          L'Ère des Small Language Models (SLM) dans l'Automobile : Architecture, Optimisation
          et Cas d'Usage de l'IA Embarquée (Edge AI).
        </div>
    
        <div class="footer-block">
          <span>Auteur</span>
          <strong>Martin Villette</strong>
        </div>
    
        <div class="footer-block">
          <span>Tuteur</span>
          <strong>Julien Velcin</strong>
        </div>
    
        <div class="footer-block">
          <span>Établissement</span>
          <strong>Centrale de Lyon</strong>
        </div>
    
        <div class="footer-block">
          <span>Module</span>
          <strong>25_I_G_S09_MOS_04_4 - Nouvelles technologies de l'information et de la communication</strong>
        </div>
    
        <div class="footer-bottom">
          <span>© 2026 Martin Villette - Centrale Lyon</span>
          <span>Veille Technologique · S9 MOS</span>
        </div>
    
      </div>
    </footer>
  </div>

  <div id="hint">↓ Scroll pour découvrir ↓</div>

  <script type="importmap">
    { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
  </script>

  <script type="module" src="../js/methodology.js"></script>

  <script>
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwavboJq92GEn1vyeLpHYveqHZufqgMgRslfZWgVAhCO5hYUehvGEEOsYea0-ySyNi4Ig/exec";
    
    async function loadNews() {
        const listContainer = document.getElementById('news-list');
        try {
            const response = await fetch(GOOGLE_SCRIPT_URL);
            const data = await response.json();
            
            // Ici on affiche tout sans filtre de topic, ou juste les sujets très techniques
            listContainer.innerHTML = '';
            data.slice(0, 10).forEach(article => {
                const li = document.createElement('li');
                li.innerHTML = `[${article.topic.toUpperCase()}] <a href="${article.link}" target="_blank">${article.title}</a>`;
                listContainer.appendChild(li);
            });
        } catch (error) { listContainer.innerHTML = '<li>Erreur chargement flux.</li>'; }
    }
    window.onload = loadNews;
  </script>
</body>
</html>